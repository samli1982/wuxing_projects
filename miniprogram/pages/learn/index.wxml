<view class="page">
  <!-- å¯¼èˆªæ  -->
  <view class="nav">
    <view class="nav-left" bindtap="onBack">â†</view>
    <view class="nav-title">å›½åŒ»å­¦å ‚</view>
    <view class="nav-right" bindtap="onSearch">ğŸ”</view>
  </view>

  <!-- ä¸»è§†è§‰æ¨ªå¹…ï¼šä»Šæ—¥æ¨èè¯¾ -->
  <swiper class="hero-banner" autoplay="{{true}}" interval="{{5000}}" circular="{{true}}">
    <block wx:for="{{recommendedCourses}}" wx:key="course_id">
      <swiper-item>
        <view class="hero-item" bindtap="onCourseDetail" data-id="{{item.course_id}}">
          <view class="hero-icon">ğŸ“–</view>
          <view class="hero-content">
            <view class="hero-label">ä»Šæ—¥æ¨è</view>
            <view class="hero-title">{{item.title}}</view>
            <view class="hero-desc">{{item.description}}</view>
            <view class="hero-progress">
              <view class="progress-bar">
                <view class="progress-fill" style="width: {{item.progress}}%;"></view>
              </view>
              <text class="progress-text">å·²è¯» {{item.progress}}%</text>
            </view>
          </view>
          <view class="hero-play">â–¶ï¸</view>
        </view>
      </swiper-item>
    </block>
  </swiper>

  <!-- å†…å®¹åˆ†ç±»æ ‡ç­¾æ  -->
  <scroll-view class="category-tabs" scroll-x="true" show-scrollbar="false">
    <block wx:for="{{categories}}" wx:key="*this">
      <view class="category-tab {{activeCategory===item?'active':''}}" bindtap="switchCategory" data-category="{{item}}">
        {{item}}
      </view>
    </block>
  </scroll-view>

  <!-- ç²¾é€‰è¯¾ç¨‹å¡ç‰‡åˆ—è¡¨ -->
  <view class="courses-section">
    <block wx:for="{{coursesList}}" wx:key="course_id">
      <view class="course-card" bindtap="onCourseDetail" data-id="{{item.course_id}}">
        <view class="course-header">
          <view class="course-icon">{{item.course_icon}}</view>
          <view class="course-meta">
            <view class="course-category">{{item.category}}</view>
            <view class="course-collect {{item.is_collected?'active':''}}" bindtap="toggleCollect" data-id="{{item.course_id}}" catchTap>â¤ï¸</view>
          </view>
        </view>
        <view class="course-title">{{item.title}}</view>
        <view class="course-info">
          <text>ğŸ•’ {{item.duration}}</text>
          <text>ã€€ï½œã€€</text>
          <text>ğŸ“– {{item.type}}</text>
        </view>
        <view class="course-progress">
          <view class="progress-bar">
            <view class="progress-fill" style="width: {{item.progress}}%;"></view>
          </view>
          <text class="progress-text">ç»§ç»­å­¦ä¹ ï¼ˆå·²è¯» {{item.progress}}%ï¼‰</text>
        </view>
      </view>
    </block>
  </view>

  <!-- ç»å…¸æ–‡çŒ®é˜…è¯»åŒº -->
  <view class="classics-section">
    <view class="section-title">ğŸ“˜ å¤ç±åŸæ–‡ç²¾é€‰</view>
    <block wx:for="{{classicsList}}" wx:key="classic_id">
      <view class="classic-card" bindtap="onClassicDetail" data-id="{{item.classic_id}}">
        <view class="classic-name">ã€Š{{item.name}}ã€‹èŠ‚é€‰</view>
        <view class="classic-excerpt">
          "{{item.excerpt}}"
        </view>
        <view class="classic-footer">
          <view class="classic-annotation" bindtap="onAnnotation" data-id="{{item.classic_id}}" catchTap>
            <text>ğŸ“Œ</text>
            <text>æ³¨è§£</text>
          </view>
          <view class="classic-link" bindtap="onRelatedCourse" data-course-id="{{item.related_course}}" catchTap>
            <text>ğŸ”—</text>
            <text>å…³è”è¯¾ç¨‹</text>
          </view>
        </view>
      </view>
    </block>
  </view>

  <!-- è§†é¢‘è®²å ‚å…¥å£ -->
  <view class="video-section">
    <view class="section-title">ğŸ¥ åå¸ˆè®²å ‚</view>
    <block wx:for="{{videosList}}" wx:key="video_id">
      <view class="video-card" bindtap="onVideoPlay" data-id="{{item.video_id}}">
        <view class="video-thumbnail">
          <image src="{{item.thumbnail_url}}" mode="aspectFill"></image>
          <view class="video-play-icon">â–¶ï¸</view>
        </view>
        <view class="video-info">
          <view class="video-speaker">{{item.speaker}}ä¸»è®²</view>
          <view class="video-title">{{item.title}}</view>
          <view class="video-meta">
            <text>â–¶ï¸ {{item.duration}}</text>
            <text>ã€€ï½œã€€</text>
            <text>ğŸ‘ï¸ {{item.views_text}}</text>
          </view>
        </view>
      </view>
    </block>
  </view>

  <!-- ç¤¾åŒºé—®ç­” & ç¬”è®°åŒº -->
  <view class="community-section">
    <view class="community-tabs">
      <view class="community-tab {{activeTab==='qa'?'active':''}}" bindtap="switchCommunityTab" data-tab="qa">é—®ç­”</view>
      <view class="community-tab {{activeTab==='notes'?'active':''}}" bindtap="switchCommunityTab" data-tab="notes">æˆ‘çš„ç¬”è®°</view>
    </view>

    <!-- é—®ç­”å†…å®¹ -->
    <view class="community-content" wx:if="{{activeTab==='qa'}}">
      <block wx:for="{{qaList}}" wx:key="qa_id">
        <view class="qa-item">
          <view class="qa-question">Q: {{item.question}}</view>
          <view class="qa-answer">A: {{item.answer}}</view>
          <view class="qa-actions">
            <view class="qa-action" bindtap="toggleQaLike" data-id="{{item.qa_id}}">ğŸ‘ {{item.likes}}</view>
            <view class="qa-action" bindtap="toggleQaCollect" data-id="{{item.qa_id}}">â¤ï¸ æ”¶è—</view>
          </view>
        </view>
      </block>
    </view>

    <!-- ç¬”è®°å†…å®¹ -->
    <view class="community-content" wx:if="{{activeTab==='notes'}}">
      <block wx:for="{{notesList}}" wx:key="note_id">
        <view class="note-item" bindtap="onNoteDetail" data-id="{{item.note_id}}">
          <view class="note-title">ğŸ“ {{item.title}}</view>
          <view class="note-preview">{{item.preview}}</view>
          <view class="note-meta">{{item.created_at}}</view>
        </view>
      </block>
    </view>
  </view>
</view>
