<view class="page">
  <view class="status-bar"></view>
  <view class="nav">
    <view class="nav-left"></view>
    <view class="nav-title">æˆ‘çš„å‘½ç›˜</view>
    <view class="nav-right" bindtap="onEdit" wx:if="{{palmtrees.length > 0}}">âœï¸</view>
  </view>

  <!-- ç©ºçŠ¶æ€ï¼šæ— å‘½ç›˜æ—¶æ˜¾ç¤º -->
  <view class="empty" wx:if="{{palmtrees.length === 0}}">
    <text class="empty-icon">ğŸ“­</text>
    <view class="empty-text">
      <text class="title">æš‚æ— å‘½ç›˜è®°å½•</text>
      <text class="desc">æ‚¨è¿˜æ²¡æœ‰åˆ›å»ºä»»ä½•å‘½ç›˜ï¼Œ</text>
      <text class="desc">å‘½ç›˜æ˜¯è¿æ¥å¤©åœ°è¿è¡Œä¸ä¸ªä½“å¥åº·çš„æ¡¥æ¢ã€‚</text>
      <text class="hint">ğŸ‘‰ ç‚¹å‡»å³ä¸‹è§’ã€+ã€‘æŒ‰é’®å¼€å§‹åˆ›å»º</text>
    </view>
  </view>

  <!-- æœ‰å‘½ç›˜æ—¶æ˜¾ç¤ºå†…å®¹ -->
  <block wx:if="{{palmtrees.length > 0}}">
    <scroll-view class="user-selector" scroll-x="true" show-scrollbar="false">
      <block wx:for="{{palmtrees}}" wx:key="id">
        <view class="user-item {{selectedId===item.id?'active':''}}" bindtap="switchPalmtree" bindlongpress="onLongPress" data-id="{{item.id}}">
          <view class="nickname">{{item.nickname}}</view>
          <view class="year">{{item.year}}å¹´</view>
        </view>
      </block>
    </scroll-view>

  <view class="ident">
    <view class="nick">{{nickname}} çš„å‘½ç›˜</view>
    <view class="birth" style="white-space: pre-wrap; word-wrap: break-word;">{{birthInfo}}</view>
  </view>

  <view class="card bazi">
    <view class="bazi-header">
      <text>å››æŸ±å…«å­—</text>
    </view>
    <view class="grid">
      <!-- å¹´æŸ±å¤©å¹² -->
      <view class="cell">
        <view class="char-container">
          <view class="wuxing-label" style="color: {{wuxingColors[heavenlyStemWuxing[eight.year.heavenly_stem]]}}">
            {{heavenlyStemWuxing[eight.year.heavenly_stem]}}
          </view>
          <view class="char-row">
            <view class="char-left"></view>
            <text class="char-text" style="color: {{wuxingColors[heavenlyStemWuxing[eight.year.heavenly_stem]]}}">
              {{eight.year.heavenly_stem}}
            </text>
            <view class="char-right"></view>
          </view>
          <view class="tengod-label">{{tenGodsMap[eight.day.heavenly_stem][eight.year.heavenly_stem]}}</view>
        </view>
      </view>
      <!-- æœˆæŸ±å¤©å¹² -->
      <view class="cell">
        <view class="char-container">
          <view class="wuxing-label" style="color: {{wuxingColors[heavenlyStemWuxing[eight.month.heavenly_stem]]}}">
            {{heavenlyStemWuxing[eight.month.heavenly_stem]}}
          </view>
          <view class="char-row">
            <view class="char-left"></view>
            <text class="char-text" style="color: {{wuxingColors[heavenlyStemWuxing[eight.month.heavenly_stem]]}}">
              {{eight.month.heavenly_stem}}
            </text>
            <view class="char-right"></view>
          </view>
          <view class="tengod-label">{{tenGodsMap[eight.day.heavenly_stem][eight.month.heavenly_stem]}}</view>
        </view>
      </view>
      <!-- æ—¥æŸ±å¤©å¹² -->
      <view class="cell highlight">
        <view class="char-container">
          <view class="wuxing-label" style="color: {{wuxingColors[heavenlyStemWuxing[eight.day.heavenly_stem]]}}">
            {{heavenlyStemWuxing[eight.day.heavenly_stem]}}
          </view>
          <view class="char-row">
            <view class="char-left"></view>
            <text class="char-text" style="color: {{wuxingColors[heavenlyStemWuxing[eight.day.heavenly_stem]]}}">
              {{eight.day.heavenly_stem}}
            </text>
            <view class="char-right"></view>
          </view>
          <view class="tengod-label">æ—¥å…ƒ</view>
        </view>
      </view>
      <!-- æ—¶æŸ±å¤©å¹² -->
      <view class="cell">
        <view class="char-container">
          <view class="wuxing-label" style="color: {{wuxingColors[heavenlyStemWuxing[eight.hour.heavenly_stem]]}}">
            {{heavenlyStemWuxing[eight.hour.heavenly_stem]}}
          </view>
          <view class="char-row">
            <view class="char-left"></view>
            <text class="char-text" style="color: {{wuxingColors[heavenlyStemWuxing[eight.hour.heavenly_stem]]}}">
              {{eight.hour.heavenly_stem}}
            </text>
            <view class="char-right"></view>
          </view>
          <view class="tengod-label">{{tenGodsMap[eight.day.heavenly_stem][eight.hour.heavenly_stem]}}</view>
        </view>
      </view>

      <!-- å¹´æŸ±åœ°æ”¯ -->
      <view class="cell">
        <view class="char-container">
          <view class="wuxing-label" style="color: {{wuxingColors[earthlyBranchWuxing[eight.year.earthly_branch]]}}">
            {{earthlyBranchWuxing[eight.year.earthly_branch]}}
          </view>
          <view class="char-row">
            <view class="char-left"></view>
            <text class="char-text" style="color: {{wuxingColors[earthlyBranchWuxing[eight.year.earthly_branch]]}}">
              {{eight.year.earthly_branch}}
            </text>
            <view class="char-right"></view>
          </view>
          <view class="tengod-label" wx:if="{{eight.year.earthly_branch_tengod}}">{{eight.year.earthly_branch_tengod}}</view>
          <view class="tengod-label" wx:else></view>
        </view>
      </view>
      <!-- æœˆæŸ±åœ°æ”¯ -->
      <view class="cell">
        <view class="char-container">
          <view class="wuxing-label" style="color: {{wuxingColors[earthlyBranchWuxing[eight.month.earthly_branch]]}}">
            {{earthlyBranchWuxing[eight.month.earthly_branch]}}
          </view>
          <view class="char-row">
            <view class="char-left"></view>
            <text class="char-text" style="color: {{wuxingColors[earthlyBranchWuxing[eight.month.earthly_branch]]}}">
              {{eight.month.earthly_branch}}
            </text>
            <view class="char-right"></view>
          </view>
          <view class="tengod-label" wx:if="{{eight.month.earthly_branch_tengod}}">{{eight.month.earthly_branch_tengod}}</view>
          <view class="tengod-label" wx:else></view>
        </view>
      </view>
      <!-- æ—¥æŸ±åœ°æ”¯ -->
      <view class="cell highlight">
        <view class="char-container">
          <view class="wuxing-label" style="color: {{wuxingColors[earthlyBranchWuxing[eight.day.earthly_branch]]}}">
            {{earthlyBranchWuxing[eight.day.earthly_branch]}}
          </view>
          <view class="char-row">
            <view class="char-left"></view>
            <text class="char-text" style="color: {{wuxingColors[earthlyBranchWuxing[eight.day.earthly_branch]]}}">
              {{eight.day.earthly_branch}}
            </text>
            <view class="char-right"></view>
          </view>
          <view class="tengod-label" wx:if="{{eight.day.earthly_branch_tengod}}">{{eight.day.earthly_branch_tengod}}</view>
          <view class="tengod-label" wx:else></view>
        </view>
      </view>
      <!-- æ—¶æŸ±åœ°æ”¯ -->
      <view class="cell">
        <view class="char-container">
          <view class="wuxing-label" style="color: {{wuxingColors[earthlyBranchWuxing[eight.hour.earthly_branch]]}}">
            {{earthlyBranchWuxing[eight.hour.earthly_branch]}}
          </view>
          <view class="char-row">
            <view class="char-left"></view>
            <text class="char-text" style="color: {{wuxingColors[earthlyBranchWuxing[eight.hour.earthly_branch]]}}">
              {{eight.hour.earthly_branch}}
            </text>
            <view class="char-right"></view>
          </view>
          <view class="tengod-label" wx:if="{{eight.hour.earthly_branch_tengod}}">{{eight.hour.earthly_branch_tengod}}</view>
          <view class="tengod-label" wx:else></view>
        </view>
      </view>
    </view>
    <view class="note">çº³éŸ³ï¼š{{nayin}}ï½œç©ºäº¡ï¼š{{kongwang}}ï½œèƒå…ƒï¼š{{taiyuan}}</view>
  </view>

  <view class="card wuxing">
    <view class="section-title">ğŸ“Š äº”è¡Œå¼ºå¼±åˆ†å¸ƒ</view>
    <view class="bar" bindtap="onBarTap" data-name="æœ¨"><view class="bar-fill wood" style="width: {{barWidthWood}};"></view><text class="bar-label">æœ¨ {{wuxingWood}}</text></view>
    <view class="bar" bindtap="onBarTap" data-name="ç«"><view class="bar-fill fire" style="width: {{barWidthFire}};"></view><text class="bar-label">ç« {{wuxingFire}}</text></view>
    <view class="bar" bindtap="onBarTap" data-name="åœŸ"><view class="bar-fill earth" style="width: {{barWidthEarth}};"></view><text class="bar-label">åœŸ {{wuxingEarth}}</text></view>
    <view class="bar" bindtap="onBarTap" data-name="é‡‘"><view class="bar-fill metal" style="width: {{barWidthMetal}};"></view><text class="bar-label">é‡‘ {{wuxingMetal}}</text></view>
    <view class="bar" bindtap="onBarTap" data-name="æ°´"><view class="bar-fill water" style="width: {{barWidthWater}};"></view><text class="bar-label" style="color: #FFFFFF;">æ°´ {{wuxingWater}}</text></view>
    <view class="useful-gods">
      <text class="gods-title">ğŸ¯ å–œç”¨ç¥ï¼š</text>
      <block wx:for="{{usefulGods}}" wx:key="*this">
        <view class="god-tag">{{item}}</view>
      </block>
      <view class="hint" bindtap="onShowGodsTheory">ï¼Ÿ</view>
    </view>
  </view>

  <view class="card wuyun">
    <view class="section-title">ğŸŒ¤ï¸ {{wuyunliuqi.year}}å¹´ äº”è¿å…­æ°”</view>
    <view class="wuyun-row">
      <view class="wuyun-tag gold">ã€ä¸­è¿ã€‘{{wuyunliuqi.transportation}}</view>
    </view>
    <view class="wuyun-row">
      <view class="wuyun-tag fire">ã€å¸å¤©ã€‘{{wuyunliuqi.tiansi}}</view>
      <view class="wuyun-tag metal">ã€åœ¨æ³‰ã€‘{{wuyunliuqi.zaiquan}}</view>
    </view>
    <view class="wuyun-climate">æ°”å€™ç‰¹å¾ï¼š{{wuyunliuqi.climate}}</view>
    <view class="wuyun-warnings">
      <view class="warn-title">å¥åº·æç¤ºï¼š</view>
      <block wx:for="{{wuyunliuqi.health_warnings}}" wx:key="index">
        <view class="warn-item">â€¢ {{item}}</view>
      </block>
    </view>
  </view>

  <view class="card constitution">
    <view class="section-title">ğŸ§˜â€â™‚ï¸ ä½“è´¨ç±»å‹åˆ¤å®š</view>
    <view class="ctype">{{constitution}}</view>
    <view class="tags">
      <view class="tag hot">åçƒ­ä½“è´¨</view>
      <view class="tag bright">æœ¨ç«é€šæ˜</view>
    </view>
    <view class="desc">æˆå› åˆ†æï¼š{{analysis.cause}}</view>
    <view class="desc">æ˜“å‘ç—‡çŠ¶ï¼š{{analysis.symptom}}</view>
    <view class="desc">è°ƒå…»æ–¹å‘ï¼š{{analysis.tune}}</view>
  </view>

  <view class="card tips">
    <view class="tabs">
      <view class="tab {{activeTab==='diet'?'active':''}}" bindtap="switchTab" data-tab="diet">ğŸµ é¥®é£Ÿ</view>
      <view class="tab {{activeTab==='lifestyle'?'active':''}}" bindtap="switchTab" data-tab="lifestyle">ğŸ§˜â€â™€ï¸ èµ·å±…</view>
      <view class="tab {{activeTab==='emotion'?'active':''}}" bindtap="switchTab" data-tab="emotion">â¤ï¸ æƒ…å¿—</view>
      <view class="tab {{activeTab==='herb'?'active':''}}" bindtap="switchTab" data-tab="herb">ğŸŒ¿ è¯å¼•</view>
    </view>
    <view class="tip-list">
      <block wx:for="{{displayTips}}" wx:key="index">
        <view class="tip-item">
          <view class="dot"></view>
          <text class="tip-text">{{item.text}}</text>
        </view>
      </block>
    </view>
  </view>

    <view class="bottom-actions">
      <button class="btn save" bindtap="onSave">ä¿å­˜å‘½ç›˜</button>
      <button class="btn share" open-type="share">åˆ†äº«æŠ¥å‘Š</button>
      <button class="btn detail" bindtap="onDetail">æŸ¥çœ‹è¯¦è§£</button>
    </view>
  </block>

  <!-- æ‚¬æµ®æ–°å»ºæŒ‰é’® -->
  <movable-area class="fab-area">
    <movable-view class="fab" direction="all" bindtap="onCreate" x="{{fabX}}" y="{{fabY}}">
      <text>+</text>
    </movable-view>
  </movable-area>
</view>
