<view class="page">
  <view class="status-bar"></view>
  <!-- å¯¼èˆªæ  -->
  <view class="nav">
    <view class="nav-left"></view>
    <view class="nav-title">æˆ‘çš„</view>
    <view class="nav-right"></view>
  </view>

  <!-- é¡¶éƒ¨ç”¨æˆ·ä¿¡æ¯åŒº -->
  <view class="user-info-card" bindtap="onProfileEdit">
    <view class="user-header">
      <view class="avatar" style="background-color: {{userInfo.avatar_color}};">
        <text>{{userInfo.nickname.charAt(0)}}</text>
      </view>
      <view class="user-content">
        <view class="user-greeting">
          <text class="greeting-text">æ¬¢è¿å›æ¥ï¼Œ{{userInfo.nickname}}</text>
          <text class="greeting-emoji">ğŸŒ¿</text>
        </view>
        <view class="user-stats">
          <text>å·²è¿ç»­å­¦ä¹  {{userInfo.consecutive_days}} å¤©</text>
        </view>
        <view class="user-stats">
          <text>ç´¯è®¡åˆ›å»º {{userInfo.total_palmtrees}} ä¸ªå‘½ç›˜</text>
        </view>
      </view>
      <view class="edit-icon" bindtap="onProfileEdit" catchTap>âœï¸</view>
    </view>
  </view>

  <!-- å¿«æ·å…¥å£å›¾æ ‡ç»„ -->
  <view class="quick-access">
    <view class="quick-grid">
      <view class="quick-item" bindtap="onQuickAction" data-action="palmtrees">
        <view class="quick-icon"></view>
        <view class="quick-text">æˆ‘çš„å‘½ç›˜</view>
      </view>
      <view class="quick-item" bindtap="onQuickAction" data-action="favorites">
        <view class="quick-icon">â¤ï¸</view>
        <view class="quick-text">æ”¶è—å¤¹</view>
      </view>
      <view class="quick-item" bindtap="onQuickAction" data-action="notes">
        <view class="quick-icon">ğŸ“</view>
        <view class="quick-text">æˆ‘çš„ç¬”è®°</view>
      </view>
      <view class="quick-item" bindtap="onQuickAction" data-action="history">
        <view class="quick-icon">ğŸ“</view>
        <view class="quick-text">å­¦ä¹ è®°å½•</view>
      </view>
      <view class="quick-item" bindtap="onQuickAction" data-action="backup">
        <view class="quick-icon">ğŸ“</view>
        <view class="quick-text">æ•°æ®å¤‡ä»½</view>
      </view>
      <view class="quick-item" bindtap="onQuickAction" data-action="theme">
        <view class="quick-icon">ğŸŒ™</view>
        <view class="quick-text">ä¸»é¢˜è®¾ç½®</view>
      </view>
      <view class="quick-item" bindtap="onQuickAction" data-action="service">
        <view class="quick-icon">ğŸ“</view>
        <view class="quick-text">è”ç³»å®¢æœ</view>
      </view>
      <view class="quick-item" bindtap="onQuickAction" data-action="guide">
        <view class="quick-icon">â“</view>
        <view class="quick-text">ä½¿ç”¨æŒ‡å—</view>
      </view>
    </view>
  </view>

  <!-- æˆ‘çš„å†…å®¹ç®¡ç†åŒº -->
  <view class="content-section">
    <!-- æˆ‘çš„å‘½ç›˜ -->
    <view class="content-card">
      <view class="card-header">
        <text class="card-icon">ğŸ“œ</text>
        <text class="card-title">æˆ‘çš„å‘½ç›˜</text>
      </view>
      <view class="card-content">
        <view class="palmtree-item">
          <view class="item-title">æœ€è¿‘å‘½ç›˜ï¼š{{userStats.last_palmtree.name}}</view>
          <view class="item-meta">
            <text>ğŸ“… åˆ›å»ºäºï¼š{{userStats.last_palmtree.created_at}}</text>
          </view>
          <view class="item-meta">
            <text>ğŸ¯ ä½“è´¨ç±»å‹ï¼š{{userStats.last_palmtree.constitution}}</text>
          </view>
        </view>
        <view class="card-action" bindtap="onViewAllPalmtrees">
          <text>ğŸ‘‰ æŸ¥çœ‹å…¨éƒ¨ {{userStats.total_palmtrees}} ä¸ªå‘½ç›˜</text>
          <text class="arrow">></text>
        </view>
      </view>
    </view>

    <!-- æˆ‘çš„ç¬”è®° & æ”¶è— -->
    <view class="content-card">
      <view class="card-header">
        <text class="card-icon">ğŸ“</text>
        <text class="card-title">æˆ‘çš„ç¬”è®° & æ”¶è—</text>
      </view>
      <view class="card-content">
        <view class="stats-grid">
          <view class="stat-item">
            <view class="stat-number">{{userStats.notes_count}}</view>
            <view class="stat-label">ç¬”è®°</view>
          </view>
          <view class="stat-item">
            <view class="stat-number">{{userStats.favorites.courses}}</view>
            <view class="stat-label">è¯¾ç¨‹</view>
          </view>
          <view class="stat-item">
            <view class="stat-number">{{userStats.favorites.herbs}}</view>
            <view class="stat-label">è¯ç²¾</view>
          </view>
          <view class="stat-item">
            <view class="stat-number">{{userStats.favorites.palmtrees}}</view>
            <view class="stat-label">å‘½ç›˜</view>
          </view>
        </view>
        <view class="card-action" bindtap="onViewNotes">
          <text>ğŸ‘‰ å‰å¾€ç¬”è®°ä¸­å¿ƒ</text>
          <text class="arrow">></text>
        </view>
      </view>
    </view>

    <!-- å­¦ä¹ è¿›åº¦ -->
    <view class="content-card">
      <view class="card-header">
        <text class="card-icon">ğŸ“Š</text>
        <text class="card-title">å­¦ä¹ è¿›åº¦</text>
      </view>
      <view class="card-content">
        <view class="learning-item" wx:for="{{userStats.learning_progress}}" wx:key="index" bindtap="onContinueLearn" data-course-id="{{item.course_id}}">
          <view class="learning-title">{{item.title}}</view>
          <view class="progress-bar">
            <view class="progress-fill" style="width: {{item.progress}}%;"></view>
          </view>
          <view class="progress-text">å·²å®Œæˆ {{item.progress}}%</view>
        </view>
        <view class="learning-stats">
          <text>ğŸ“ˆ æ€»è®¡å­¦ä¹ æ—¶é•¿ï¼š{{userStats.learning_duration}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- ç³»ç»Ÿè®¾ç½®ä¸å¸®åŠ© -->
  <view class="settings-section">
    <view class="settings-title">ç³»ç»Ÿè®¾ç½®</view>
    
    <view class="settings-list">
      <view class="settings-item" bindtap="onToggleTheme">
        <view class="settings-label">
          <text class="settings-icon">ğŸŒ™</text>
          <text class="settings-name">ä¸»é¢˜æ¨¡å¼</text>
        </view>
        <view class="settings-value">
          <text>{{themeMode === 'dark' ? 'æš—é»‘æ¨¡å¼' : 'äº®è‰²æ¨¡å¼'}}</text>
          <text class="arrow">></text>
        </view>
      </view>

      <view class="settings-item" bindtap="onOpenSettings" data-type="privacy">
        <view class="settings-label">
          <text class="settings-icon">ğŸ”</text>
          <text class="settings-name">éšç§è®¾ç½®</text>
        </view>
        <view class="settings-value">
          <text class="arrow">></text>
        </view>
      </view>

      <view class="settings-item" bindtap="onOpenSettings" data-type="notifications">
        <view class="settings-label">
          <text class="settings-icon">ğŸ””</text>
          <text class="settings-name">é€šçŸ¥ä¸­å¿ƒ</text>
        </view>
        <view class="settings-value">
          <text class="arrow">></text>
        </view>
      </view>

      <view class="settings-item" bindtap="onOpenSettings" data-type="backup">
        <view class="settings-label">
          <text class="settings-icon">ğŸ’¾</text>
          <text class="settings-name">æ•°æ®å¤‡ä»½</text>
        </view>
        <view class="settings-value">
          <text class="arrow">></text>
        </view>
      </view>

      <view class="settings-item" bindtap="onOpenSettings" data-type="about">
        <view class="settings-label">
          <text class="settings-icon">â„¹ï¸</text>
          <text class="settings-name">å…³äºæˆ‘ä»¬</text>
        </view>
        <view class="settings-value">
          <text>v1.0.0</text>
          <text class="arrow">></text>
        </view>
      </view>

      <view class="settings-item" bindtap="onOpenSettings" data-type="feedback">
        <view class="settings-label">
          <text class="settings-icon">âœ‰ï¸</text>
          <text class="settings-name">æ„è§åé¦ˆ</text>
        </view>
        <view class="settings-value">
          <text class="arrow">></text>
        </view>
      </view>

      <view class="settings-item" bindtap="onOpenSettings" data-type="guide">
        <view class="settings-label">
          <text class="settings-icon">ğŸ“˜</text>
          <text class="settings-name">ä½¿ç”¨æŒ‡å—</text>
        </view>
        <view class="settings-value">
          <text class="arrow">></text>
        </view>
      </view>
    </view>
  </view>

  <!-- é€€å‡ºç™»å½•æŒ‰é’® -->
  <view class="logout-section">
    <view class="button logout" bindtap="onLogout">ğŸšª é€€å‡ºç™»å½•</view>
  </view>
</view>
