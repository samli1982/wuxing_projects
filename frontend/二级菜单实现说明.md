# äºŒçº§èœå•å®ç°è¯´æ˜

## âœ… å®ç°å†…å®¹

### èœå•ç»“æ„è°ƒæ•´

**ä¹‹å‰**ï¼ˆä¸€çº§èœå•ï¼‰:
```
â”œâ”€â”€ é¦–é¡µ
â”œâ”€â”€ ç”¨æˆ·ç®¡ç†
â”œâ”€â”€ è§’è‰²ç®¡ç†
â””â”€â”€ æƒé™ç®¡ç†
```

**ç°åœ¨**ï¼ˆäºŒçº§èœå•ï¼‰:
```
â”œâ”€â”€ é¦–é¡µ
â””â”€â”€ ç³»ç»Ÿç®¡ç†
    â”œâ”€â”€ ç”¨æˆ·ç®¡ç†
    â”œâ”€â”€ è§’è‰²ç®¡ç†
    â””â”€â”€ æƒé™ç®¡ç†
```

---

## ğŸ“ ä¿®æ”¹çš„æ–‡ä»¶

### 1. èœå•é…ç½®æ–‡ä»¶

**æ–‡ä»¶**: `/frontend/src/config/menu.js`

**ä¸»è¦å˜æ›´**:

#### 1.1 èœå•ç»“æ„æ”¯æŒ children
```javascript
export const menuConfig = [
  {
    path: '/',
    name: 'Dashboard',
    meta: { title: 'é¦–é¡µ', icon: 'HomeFilled' }
  },
  {
    path: '/system',
    name: 'System',
    meta: { title: 'ç³»ç»Ÿç®¡ç†', icon: 'Setting' },
    children: [  // âœ… æ·»åŠ å­èœå•
      {
        path: '/user',
        name: 'UserManagement',
        meta: { 
          title: 'ç”¨æˆ·ç®¡ç†', 
          icon: 'User',
          permission: 'system:user'
        }
      },
      {
        path: '/role',
        name: 'RoleManagement',
        meta: { 
          title: 'è§’è‰²ç®¡ç†', 
          icon: 'Avatar',
          permission: 'system:role'
        }
      },
      {
        path: '/permission',
        name: 'PermissionManagement',
        meta: { 
          title: 'æƒé™ç®¡ç†', 
          icon: 'Lock',
          permission: 'system:permission'
        }
      }
    ]
  }
]
```

#### 1.2 é€’å½’è¿‡æ»¤å‡½æ•°
```javascript
export function filterMenuByPermission(permissions) {
  const permissionCodes = permissions.map(p => p.permissionCode)
  
  function filterMenu(menus) {
    return menus.filter(menu => {
      // é¦–é¡µä¸éœ€è¦æƒé™
      if (menu.path === '/') return true
      
      // âœ… å¤„ç†æœ‰å­èœå•çš„æƒ…å†µ
      if (menu.children && menu.children.length > 0) {
        // é€’å½’è¿‡æ»¤å­èœå•
        const filteredChildren = filterMenu(menu.children)
        
        // å¦‚æœæœ‰ä»»ä½•å­èœå•æœ‰æƒé™ï¼Œåˆ™æ˜¾ç¤ºçˆ¶èœå•
        if (filteredChildren.length > 0) {
          menu.children = filteredChildren
          return true
        }
        return false
      }
      
      // æ£€æŸ¥æ˜¯å¦æœ‰å¯¹åº”çš„æƒé™
      if (menu.meta.permission) {
        return permissionCodes.includes(menu.meta.permission)
      }
      
      return true
    })
  }
  
  return filterMenu(JSON.parse(JSON.stringify(menuConfig)))
}
```

**ç‰¹æ€§**:
- âœ… é€’å½’è¿‡æ»¤å­èœå•
- âœ… åªæœ‰å½“å­èœå•æœ‰æƒé™æ—¶ï¼Œæ‰æ˜¾ç¤ºçˆ¶èœå•
- âœ… æ·±æ‹·è´é¿å…ä¿®æ”¹åŸå§‹é…ç½®

---

### 2. å¸ƒå±€ç»„ä»¶

**æ–‡ä»¶**: `/frontend/src/layout/index.vue`

**ä¸»è¦å˜æ›´**:

#### 2.1 æ¨¡æ¿æ”¯æŒäºŒçº§èœå•
```vue
<el-menu>
  <template v-for="menu in menus" :key="menu.path">
    <!-- ä¸€çº§èœå•ï¼ˆæ— å­èœå•ï¼‰ -->
    <el-menu-item
      v-if="!menu.children || menu.children.length === 0"
      :index="menu.path"
    >
      <el-icon>
        <component :is="menu.meta.icon" />
      </el-icon>
      <template #title>{{ menu.meta.title }}</template>
    </el-menu-item>
    
    <!-- ä¸€çº§èœå•ï¼ˆæœ‰å­èœå•ï¼‰ -->
    <el-sub-menu v-else :index="menu.path">
      <template #title>
        <el-icon>
          <component :is="menu.meta.icon" />
        </el-icon>
        <span>{{ menu.meta.title }}</span>
      </template>
      
      <!-- äºŒçº§èœå• -->
      <el-menu-item
        v-for="subMenu in menu.children"
        :key="subMenu.path"
        :index="subMenu.path"
      >
        <el-icon>
          <component :is="subMenu.meta.icon" />
        </el-icon>
        <template #title>{{ subMenu.meta.title }}</template>
      </el-menu-item>
    </el-sub-menu>
  </template>
</el-menu>
```

#### 2.2 å­èœå•æ ·å¼
```css
/* å­èœå•æ ·å¼ */
:deep(.el-sub-menu__title) {
  color: #bfcbd9;
}

:deep(.el-sub-menu__title:hover) {
  background-color: #263445 !important;
  color: #409eff !important;
}

:deep(.el-sub-menu .el-menu-item) {
  background-color: #1f2d3d !important;
  min-width: 0;
}

:deep(.el-sub-menu .el-menu-item:hover) {
  background-color: #001528 !important;
}
```

---

## ğŸ¨ è§†è§‰æ•ˆæœ

### å±•å¼€çŠ¶æ€ï¼ˆå®½åº¦ 200pxï¼‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   äº”è¡Œç®¡ç†ç³»ç»Ÿ      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ  é¦–é¡µ             â”‚
â”‚ âš™ï¸  ç³»ç»Ÿç®¡ç† â–¼      â”‚
â”‚   ğŸ‘¤ ç”¨æˆ·ç®¡ç†       â”‚
â”‚   ğŸ‘¥ è§’è‰²ç®¡ç†       â”‚
â”‚   ğŸ”’ æƒé™ç®¡ç†       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ”¶èµ·çŠ¶æ€ï¼ˆå®½åº¦ 64pxï¼‰
```
â”Œâ”€â”€â”€â”€â”
â”‚äº”è¡Œâ”‚
â”œâ”€â”€â”€â”€â”¤
â”‚ ğŸ  â”‚
â”‚ âš™ï¸  â”‚
â””â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ æƒé™æ§åˆ¶é€»è¾‘

### åœºæ™¯1: è¶…çº§ç®¡ç†å‘˜ï¼ˆæ‰€æœ‰æƒé™ï¼‰
**æƒé™**: `system:user`, `system:role`, `system:permission`

**æ˜¾ç¤ºèœå•**:
```
é¦–é¡µ
ç³»ç»Ÿç®¡ç†
  â”œâ”€â”€ ç”¨æˆ·ç®¡ç† âœ…
  â”œâ”€â”€ è§’è‰²ç®¡ç† âœ…
  â””â”€â”€ æƒé™ç®¡ç† âœ…
```

### åœºæ™¯2: ç®¡ç†å‘˜ï¼ˆéƒ¨åˆ†æƒé™ï¼‰
**æƒé™**: `system:user`, `system:role`

**æ˜¾ç¤ºèœå•**:
```
é¦–é¡µ
ç³»ç»Ÿç®¡ç†
  â”œâ”€â”€ ç”¨æˆ·ç®¡ç† âœ…
  â”œâ”€â”€ è§’è‰²ç®¡ç† âœ…
  â””â”€â”€ æƒé™ç®¡ç† âŒ ï¼ˆè¢«è¿‡æ»¤ï¼‰
```

### åœºæ™¯3: æ™®é€šç”¨æˆ·ï¼ˆä»…æŸ¥è¯¢æƒé™ï¼‰
**æƒé™**: æ—  `system:user`, `system:role`, `system:permission`

**æ˜¾ç¤ºèœå•**:
```
é¦–é¡µ
ç³»ç»Ÿç®¡ç† âŒ ï¼ˆå› ä¸ºæ‰€æœ‰å­èœå•éƒ½è¢«è¿‡æ»¤ï¼Œçˆ¶èœå•ä¹Ÿä¸æ˜¾ç¤ºï¼‰
```

---

## ğŸ“Š æ•°æ®æµç¨‹

```
1. ç”¨æˆ·ç™»å½•
   â†“
2. è·å–æƒé™åˆ—è¡¨
   â†“
3. filterMenuByPermission(permissions)
   â†“
4. é€’å½’è¿‡æ»¤èœå•é…ç½®
   â†“
5. è¿”å›è¿‡æ»¤åçš„èœå•æ ‘
   â†“
6. ä¿å­˜åˆ° permissionStore.menus
   â†“
7. å¸ƒå±€ç»„ä»¶æ¸²æŸ“èœå•
   â†“
8. el-sub-menu æ¸²æŸ“çˆ¶èœå•
   el-menu-item æ¸²æŸ“å­èœå•
```

---

## ğŸ¯ ç‰¹æ€§

### âœ… å·²å®ç°
- äºŒçº§èœå•ç»“æ„
- æƒé™é€’å½’è¿‡æ»¤
- å­èœå•æ ·å¼å®šåˆ¶
- æŠ˜å /å±•å¼€åŠ¨ç”»
- å›¾æ ‡æ˜¾ç¤º
- è·¯ç”±è·³è½¬
- å”¯ä¸€å±•å¼€ï¼ˆunique-openedï¼‰

### ğŸ¨ æ ·å¼ç‰¹ç‚¹
- çˆ¶èœå•èƒŒæ™¯: `#304156`
- å­èœå•èƒŒæ™¯: `#1f2d3d`ï¼ˆæ›´æ·±ï¼‰
- æ‚¬åœæ•ˆæœ: `#263445`
- æ¿€æ´»é¢œè‰²: `#409eff`
- å›¾æ ‡ä¸æ–‡å­—å¯¹é½
- æ”¶èµ·æ—¶ä»…æ˜¾ç¤ºå›¾æ ‡

---

## ğŸš€ æ‰©å±•æ–¹å¼

### æ·»åŠ æ–°çš„ä¸€çº§èœå•
```javascript
{
  path: '/content',
  name: 'Content',
  meta: { title: 'å†…å®¹ç®¡ç†', icon: 'Document' },
  children: [
    {
      path: '/article',
      name: 'Article',
      meta: { 
        title: 'æ–‡ç« ç®¡ç†', 
        icon: 'EditPen',
        permission: 'content:article'
      }
    }
  ]
}
```

### æ·»åŠ ä¸‰çº§èœå•ï¼ˆå¦‚éœ€è¦ï¼‰
åªéœ€åœ¨ `children` ä¸­ç»§ç»­åµŒå¥— `children` å³å¯ï¼Œè¿‡æ»¤å‡½æ•°ä¼šé€’å½’å¤„ç†ã€‚

---

## âœ… æµ‹è¯•éªŒè¯

### 1. åˆ·æ–°é¡µé¢
è®¿é—® http://localhost:3000

### 2. ç™»å½•
ä½¿ç”¨ `admin / admin123`

### 3. æŸ¥çœ‹èœå•
- âœ… æ˜¾ç¤º"é¦–é¡µ"ï¼ˆä¸€çº§èœå•ï¼Œæ— å­èœå•ï¼‰
- âœ… æ˜¾ç¤º"ç³»ç»Ÿç®¡ç†"ï¼ˆä¸€çº§èœå•ï¼Œæœ‰å­èœå•ï¼‰
  - âœ… ç‚¹å‡»å±•å¼€ï¼Œæ˜¾ç¤º3ä¸ªå­èœå•
  - âœ… ç”¨æˆ·ç®¡ç†
  - âœ… è§’è‰²ç®¡ç†
  - âœ… æƒé™ç®¡ç†

### 4. æµ‹è¯•æŠ˜å 
- ç‚¹å‡»é¡¶éƒ¨æŠ˜å å›¾æ ‡
- âœ… èœå•å®½åº¦å˜ä¸º 64px
- âœ… ä»…æ˜¾ç¤ºå›¾æ ‡
- âœ… é¼ æ ‡æ‚¬åœæ˜¾ç¤ºå®Œæ•´èœå•

### 5. æµ‹è¯•æƒé™
- åˆ›å»ºä¸€ä¸ªåªæœ‰ç”¨æˆ·ç®¡ç†æƒé™çš„ç”¨æˆ·
- ç™»å½•ååº”è¯¥åªçœ‹åˆ°"ç”¨æˆ·ç®¡ç†"å­èœå•

---

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **è·¯ç”±é…ç½®ä¸å˜**: å­èœå•çš„ path ä»ç„¶æ˜¯ç‹¬ç«‹çš„è·¯ç”±è·¯å¾„ï¼ˆå¦‚ `/user`ï¼‰ï¼Œä¸æ˜¯ç›¸å¯¹è·¯å¾„
2. **å›¾æ ‡ç»„ä»¶**: ä½¿ç”¨ Element Plus çš„å›¾æ ‡ç»„ä»¶åï¼ˆå¦‚ `Setting`, `User`, `Avatar`, `Lock`ï¼‰
3. **æƒé™ç¼–ç **: å­èœå•çš„æƒé™ç¼–ç ä¸ä¹‹å‰ä¿æŒä¸€è‡´
4. **å”¯ä¸€å±•å¼€**: `unique-opened` å±æ€§ç¡®ä¿åŒæ—¶åªèƒ½å±•å¼€ä¸€ä¸ªçˆ¶èœå•

---

## ğŸ‰ æ€»ç»“

ç°åœ¨èœå•å·²ç»å‡çº§ä¸ºäºŒçº§ç»“æ„ï¼š
- âœ… æ”¯æŒæ— é™å±‚çº§ï¼ˆé€’å½’å®ç°ï¼‰
- âœ… æƒé™æ™ºèƒ½è¿‡æ»¤
- âœ… æ ·å¼ç¾è§‚ç»Ÿä¸€
- âœ… ç”¨æˆ·ä½“éªŒè‰¯å¥½

åˆ·æ–°é¡µé¢å³å¯çœ‹åˆ°æ–°çš„èœå•ç»“æ„ï¼
